(function(){"use strict";function a(){t.setText(z<L.length+1?L[z-1]:"")}function b(){o.children.iterate(function(N){N.disableBody(!0,!0)}),n.children.iterate(function(N){N.disableBody(!0,!0)}),c()}function c(){for(let N in K)K.hasOwnProperty(N)&&K[N].ref.disableBody(!0,!0)}function d(N){C=!1,A=0,b(),t.setText("You died! Refresh the page to try again."),N.sound.play("explosion"),N.physics.shutdown(),N.input.keyboard.removeAllListeners(),N.cameras.main.shake(500),N.sound.removeByKey("music"),l.disableBody(!0,!0),q.visible=!1,r.visible=!1}if(isMobileDevice())try{swal({text:"Sorry, but this game can't be played on a mobile device.",icon:"error",closeOnClickOutside:!1}).then(function(){window.history.back()})}finally{return}var j,k,l,m,n,o,q,r,s,t,u,v,w=0,z=1,A=0>=z?Infinity:5,B=!1,C=!1,D=!1,E=!1;const F=[38,38,40,40,37,39,37,39,66,65],G=[40,40,38,38,39,37,39,37,65,66],H=document.getElementById("loading");H.innerHTML="&nbsp;";const I=function(N){return new Promise(function(O){setTimeout(O,N)})},J={type:Phaser.AUTO,width:800,height:600,physics:{default:"arcade",arcade:{gravity:{y:300},debug:!1}},scene:{preload:function(){for(let N in H.innerHTML="Loading... Please wait.",this.load.image("sky","assets/sky.png"),this.load.image("ground","assets/platform.png"),this.load.image("star","assets/star.png"),this.load.image("bomb","assets/bomb.png"),this.load.image("player","assets/player.png"),this.load.image("pause","assets/pause.png"),this.load.image("resume","assets/resume.png"),K)K.hasOwnProperty(N)&&this.load.image(K[N].key,K[N].sprite);this.load.audio("explosion",["assets/audio/explosion.mp3"]),this.load.audio("starcollect",["assets/audio/starcollect.mp3"]),this.load.audio("powerupcollect",["assets/audio/powerup.mp3"]),this.load.audio("music",["assets/audio/arcade.mp3"]),console.log("Documentation: https://photonstorm.github.io/phaser3-docs/index.html"),console.log("Uncompressed code: https://cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js")},create:function(){const N=this;for(let O in H.innerHTML="&nbsp;",j=this.add.image(J.width/2,J.height/2,"sky"),k=this.physics.add.staticGroup(),k.create(J.width/2,J.height-32,"ground").setScale(2).refreshBody(),k.create(J.width-50,J.height-380,"ground"),k.create(J.width-750,J.height-350,"ground"),k.create(J.width-300,J.height-200,"ground"),l=this.physics.add.image(10,J.height-220,"player"),l.setBounce(0.2),l.setCollideWorldBounds(!0),q=this.add.image(J.width-30,35,"pause"),q.setInteractive(),r=this.add.image(J.width-30,35,"resume"),r.visible=!1,r.setInteractive(),K)if(K.hasOwnProperty(O)){let P=Phaser.Math.Between(10,J.width-30),R=K[O].key;K[O].ref=this.physics.add.image(P,10,R);let S=K[O].ref;S.disableBody(!0,!0),this.physics.add.collider(S,k)}s=this.add.text(16,16,"Score: 0",{fontSize:"25px",fill:"#000"}),t=this.add.text(200,16,"",{fontSize:"20px",fill:"#000"}),a(),u=this.add.text(16,84,"Lives: "+A,{fontSize:"25px",fill:"#000"}),v=this.add.text(16,50,"Level: "+z,{fontSize:"25px",fill:"#000"}),m=this.input.keyboard.createCursorKeys(),o=this.physics.add.group(),this.physics.add.collider(l,k),this.physics.add.collider(o,k),this.sound.play("music",{loop:!0}),this.physics.add.collider(l,o,function(O,P){D&&!C&&(D=!1),C?D&&P.disableBody(!0,!0):(A--,1<=A?(t.setText(A+(1<A?" lives left!":" life left! Better be careful!")),l.setPosition(10,J.height-80),C=!0,D=!1,I(3e3).then(function(){a(),C=!1})):d(N))},null,this),n=this.physics.add.group({key:"star",repeat:11,setXY:{x:12,y:0,stepX:70},collider:!0}),n.children.iterate(function(O){O.setBounceY(Phaser.Math.FloatBetween(0.4,0.8))}),this.physics.add.collider(n,k),this.physics.add.overlap(l,n,function(O,P){if(P.disableBody(!0,!0),w+=10,this.sound.play("starcollect",{volume:0.25}),0===n.countActive(!0)){1<=z&&z++,n.children.iterate(function(S){S.enableBody(!0,S.x,0,!0,!0),6<=z&&(S.setBounce(1),S.setCollideWorldBounds(!0),S.setVelocity(Phaser.Math.Between(-200,200),20),S.allowGravity=!1)}),a();let Q=400>l.x?Phaser.Math.Between(400,800):Phaser.Math.Between(0,400),R=o.create(Q,16,"bomb");if(R.setBounce(1),R.setCollideWorldBounds(!0),R.setVelocity(Phaser.Math.Between(-200,200),20),R.allowGravity=!1,E)return;if(4<z){for(let S in K)if(K.hasOwnProperty(S)){let T=K[S].ref,U=K[S].spawnRate,V=Math.floor(100*Math.random())/100;if(!T.visible&&V<U){let W=Phaser.Math.Between(10,J.width-30);T.enableBody(!0,W,10,!0,!0),T.setBounce(1),T.setVelocity(Phaser.Math.Between(-200,200),20),T.allowGravity=!1,T.setCollideWorldBounds(!0);break}}}else if(4===z){let S=K.oneUp.ref,T=400>l.x?Phaser.Math.Between(400,800):Phaser.Math.Between(0,400);S.enableBody(!0,T,10,!0,!0),S.setBounce(1),S.setVelocity(Phaser.Math.Between(-200,200),20),S.allowGravity=!1,S.setCollideWorldBounds(!0)}}},null,this),this.physics.add.overlap(l,K.oneUp.ref,function(O,P){A++,this.sound.play("powerupcollect",{volume:0.5}),t.setText("You got an extra life!"),P.disableBody(!0,!0),I(2e3).then(a)},null,this),this.physics.add.overlap(l,K.invincibility.ref,function(O,P){D||(C=!0,D=!0,this.sound.play("powerupcollect",{volume:0.5}),t.setText("You obtained an invincibility potion! \nYou're invincible!"),P.disableBody(!0,!0),I(1e4).then(function(){C=!1,D=!1,a()}))},null,this),this.physics.add.overlap(l,K.stop.ref,function(O,P){for(let Q in P.disableBody(!0,!0),o.children.iterate(function(Q){Q.setVelocity(0,5),Q.setBounce(0.1),Q.allowGravity=!1}),n.children.iterate(function(Q){0!==Q.body.velocity.x&&(Q.setVelocity(0,5),Q.setBounce(0.1),Q.allowGravity=!1)}),K){let R=K[Q].ref;K.hasOwnProperty(Q)&&R.visible&&(R.setVelocity(0,5),R.setBounce(0.1),R.allowGravity=!1)}this.sound.play("powerupcollect",{volume:0.5}),t.setText("Game objects stopped!"),I(1e4).then(function(){for(let Q in o.children.iterate(function(Q){Q.setBounce(1),Q.setVelocity(Phaser.Math.Between(-200,200),20),Q.setY(Q.y-60),Q.allowGravity=!1}),n.children.iterate(function(Q){0===Q.body.velocity.x&&6<=z&&(Q.setBounce(1),Q.setVelocity(Phaser.Math.Between(-200,200),20),Q.allowGravity=!1)}),K){let R=K[Q].ref;K.hasOwnProperty(Q)&&R.visible&&(R.setBounce(1),R.setVelocity(Phaser.Math.Between(-200,200),20),R.setY(R.y-60),R.allowGravity=!1)}a()})},null,this),this.physics.add.overlap(l,K.ultimate.ref,function(O,P){for(let Q in P.disableBody(!0,!0),C=!0,D=!0,A++,o.children.iterate(function(Q){Q.setVelocity(0,5),Q.setBounce(0.1),Q.allowGravity=!1}),n.children.iterate(function(Q){0!==Q.body.velocity.x&&(Q.setVelocity(0,5),Q.setBounce(0.1),Q.allowGravity=!1)}),K){let R=K[Q].ref;K.hasOwnProperty(Q)&&R.visible&&(R.setVelocity(0,5),R.setBounce(0.1),R.allowGravity=!1)}this.sound.play("powerupcollect",{volume:0.5}),t.setText("Lives increased by one, \nyou are now invincible, \nand all game objects have been stopped!"),I(1e4).then(function(){for(let Q in C=!1,D=!1,o.children.iterate(function(Q){Q.setBounce(1),Q.setVelocity(Phaser.Math.Between(-200,200),20),Q.setY(Q.y-60),Q.allowGravity=!1}),n.children.iterate(function(Q){0===Q.body.velocity.x&&6<=z&&(Q.setBounce(1),Q.setVelocity(Phaser.Math.Between(-200,200),20),Q.allowGravity=!1)}),K){let R=K[Q].ref;K.hasOwnProperty(Q)&&R.visible&&(R.setBounce(1),R.setVelocity(Phaser.Math.Between(-200,200),20),R.setY(R.y-60),R.allowGravity=!1)}a()})},null,this),q.on("pointerdown",function(){this.physics.pause(),this.sound.pauseAll(),t.setText("Game paused."),q.visible=!1,r.visible=!0},this),r.on("pointerdown",function(){this.physics.resume(),this.sound.resumeAll(),a(),q.visible=!0,r.visible=!1},this),this.input.keyboard.createCombo(F),this.input.keyboard.createCombo(G,{resetOnMatch:!0}),this.input.keyboard.createCombo("powerups",{resetOnMatch:!0}),this.input.keyboard.createCombo("daredevil"),this.input.keyboard.on("keycombomatch",function(O){if(!E)if(O.keyCodes.equals(F))A+=30,function P(Q,R,S){t.setText(Q[S]),I(R).then(S<Q.length-1?function(){P(Q,R,++S)}:function(){d(N)})}(["Konami code?","Ah, you're so clever.","Why did you enter this code?","Did you think it would help you out?","Nope, it actually kills you.","LOL"],2e3,0),C=!1,q.visible=!1,b(),j.setTint(16711680),l.setTintFill(16711680),s.setTintFill(16777215),t.setTintFill(16777215),u.setTintFill(16777215),v.setTintFill(16777215);else if(O.keyCodes.equals(G))A+=30,C=!0,t.setText("Lives increased by 30."),I(2e3).then(function(){C=!C,a()});else if(O.keyCodes.equals([80,79,87,69,82,85,80,83])&&0===z){for(let P in K)if(K.hasOwnProperty(P)){let Q=K[P].ref,R=Phaser.Math.Between(10,J.width-30);Q.enableBody(!0,R,10,!0,!0),Q.setBounce(1),Q.setVelocity(Phaser.Math.Between(-200,200),20),Q.allowGravity=!1,Q.setCollideWorldBounds(!0)}}else if(O.keyCodes.equals([68,65,82,69,68,69,86,73,76])){E=!0,A=1,c();for(let P=3;4>=P;P++)L[P]="";t.setText("Daredevil mode activated!"),I(2e3).then(a)}}),0>=A&&d(this)},update:function(){if(u.setText("Lives: "+(isFinite(A)?A:"\u221E")),v.setText("Level: "+z),s.setText("Score: "+w),l.setVelocityX(m.left.isDown?-160:m.right.isDown?160:0),m.up.isDown&&l.body.touching.down&&!B?(l.setVelocityY(-330),B=!0):!m.up.isDown&&(B=!1),C&&D?l.setTintFill(16776960):C?l.setTintFill(16755456):l.clearTint(),D&&!C)throw new Error("canDestroy should NEVER be true if the player is not invincible.");if(0>z)throw new Error("Level cannot be negative: it is "+z+".");530<=l.y&&(l.y=510)}}},K={ultimate:{sprite:"assets/ultimatepotion.png",key:"ultimate",spawnRate:0.05},invincibility:{sprite:"assets/invinciblepotion.png",key:"invincibility",spawnRate:0.2},stop:{sprite:"assets/stoppotion.png",key:"stop",spawnRate:0.6},oneUp:{sprite:"assets/lifepotion.png",key:"1up",spawnRate:0.6}},L=["Welcome to Star Collector - a platform game! \n\nUse the arrow keys to move and jump. \n\nCollect every star to progress \nthrough the game!","Don't touch the bomb!","Yikes! Two bombs!","Hey look, a life potion! \nGrab it for an extra life!","Starting from this level, power-ups will \noccasionally spawn to help you out. There \nare "+Object.keys(K).length+" of them. Grab them and see what they \ndo!","Hey look, the stars move now!","Does that make this game harder?","Hey, this game wasn't meant to be easy.","It would quickly get boring if \nthat was the case.","Are these messages distracting?","Ok, I'll stop.","So, how was your day so far?","Good? That's good.","Ok, I'm stopping for real this time!","xD"],M=new Phaser.Game(J);document.addEventListener("DOMContentLoaded",function(){window.canvas=document.getElementsByTagName("canvas")[0],window.context=window.canvas.getContext("webgl");var O=["Made with <a href='https://phaser.io/' target='_blank'>Phaser.JS</a>.","Music: <a href='https://www.youtube.com/watch?v=JV41UkBQDhE' target='_blank'>Vexento - Arcade</a>","Source code on <a href='https://github.com/AlanLuu/AlanLuu.github.io/blob/master/game/game.js' target='_blank'>GitHub</a>"];for(let Q,P=0;P<O.length;P++)Q=document.createElement("p"),Q.innerHTML=O[P],Q.className="bottom",document.body.appendChild(Q)})})();